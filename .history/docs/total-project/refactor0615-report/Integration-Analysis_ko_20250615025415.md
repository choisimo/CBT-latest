# ğŸ”„ CBT í”„ë¡œì íŠ¸ í†µí•© ë¶„ì„ ë³´ê³ ì„œ (Rev. 3.0)

## ğŸ“‹ ëª©ì°¨

```mermaid
graph TB
    subgraph "ğŸ“Š ë¶„ì„ ì˜ì—­"
        A[ì•„í‚¤í…ì²˜ ê¶Œì¥ì‚¬í•­]
        B[ì—”í‹°í‹° ë¹„êµ]
        C[ì„œë¹„ìŠ¤ ê³„ì¸µ ë¹„êµ]
        D[ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ ë¹„êµ]
        E[ì˜ì¡´ì„± êµ¬ì„± ë¹„êµ]
    end
    
    A --> B
    B --> C
    C --> D
    D --> E
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#fff3e0
    style D fill:#e8f5e8
    style E fill:#fce4ec
```

## 1. ğŸ—ï¸ ì•„í‚¤í…ì²˜ ê¶Œì¥ì‚¬í•­

# ğŸ›ï¸ ì•„í‚¤í…ì²˜ ê¶Œì¥ ë³´ê³ ì„œ: Auth-Server & CBT-back-diary

## 1. ğŸ“– ì„œë¡ 

ì´ ë³´ê³ ì„œëŠ” `Auth-Server`ì™€ `CBT-back-diary` í”„ë¡œì íŠ¸ì˜ í†µí•© ë˜ëŠ” ë¶„ë¦¬ì— ëŒ€í•œ ì•„í‚¤í…ì²˜ ê¶Œì¥ì‚¬í•­ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ê¶Œì¥ì‚¬í•­ì€ ë‹¤ìŒ ë¬¸ì„œë“¤ì— ê¸°ë¡ëœ ìƒì„¸ ë¶„ì„ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤:

```mermaid
graph LR
    subgraph "ğŸ“š ë¶„ì„ ë¬¸ì„œ"
        A[ì—”í‹°í‹° ë¹„êµ ë³´ê³ ì„œ]
        B[ì„œë¹„ìŠ¤ ê³„ì¸µ ë¹„êµ ë³´ê³ ì„œ]
        C[ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ ë¹„êµ ë³´ê³ ì„œ]
        D[ì˜ì¡´ì„± êµ¬ì„± ë¹„êµ ë³´ê³ ì„œ]
    end
    
    A --> E[ìµœì¢… ê¶Œì¥ì‚¬í•­]
    B --> E
    C --> E
    D --> E
    
    style A fill:#ffebee
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#e3f2fd
    style E fill:#fff3e0
```

- `entity_comparison_report.md`
- `service_layer_comparison_report.md`
- `data_access_layer_comparison_report.md`
- `dependency_config_comparison_report.md`

**ëª©í‘œ**: ë°ì´í„° ê²°í•©ë„, ê¸°ìˆ  ìŠ¤íƒ ì •ë ¬, ìš´ì˜ ì—­ëŸ‰, í–¥í›„ ìœ ì§€ë³´ìˆ˜ì„±ì„ ê³ ë ¤í•˜ì—¬ ê°€ì¥ ì í•©í•œ ì•„í‚¤í…ì²˜ ì ‘ê·¼ ë°©ì‹(ëª¨ë†€ë¦¬ìŠ¤ ë˜ëŠ” ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤)ì„ ê²°ì •í•©ë‹ˆë‹¤.

## 2. ğŸ“Š ì£¼ìš” ë¹„êµ ë¶„ì„ ê²°ê³¼ ìš”ì•½

ì´ì „ ë¶„ì„ ë³´ê³ ì„œì—ì„œ ë„ì¶œëœ ë‹¤ìŒ í•µì‹¬ í¬ì¸íŠ¸ë“¤ì´ ì´ ê²°ì •ì— ì¤‘ìš”í•©ë‹ˆë‹¤:

### ğŸ”— ì—”í‹°í‹° ì¤‘ë³µ ë° ê²°í•©ë„

```mermaid
erDiagram
    User ||--o{ Diary : "has"
    User ||--o{ AuthProvider : "linked"
    Diary ||--o{ Report : "generates"
    
    User {
        string userId
        string email
        string nickname
        string role
    }
    
    Diary {
        string diaryId
        string userId
        string title
        string content
        datetime createdAt
    }
    
    AuthProvider {
        string providerId
        string userId
        string provider
        string externalId
    }
```

- **ì—”í‹°í‹° ì¤‘ë³µ**: `User`, `AuthProvider`, `Diary`ì™€ ê°™ì€ í•µì‹¬ ì—”í‹°í‹°ê°€ ë‘ í”„ë¡œì íŠ¸ ëª¨ë‘ì— ì¡´ì¬í•˜ë©°, `User`ì™€ `AuthProvider` ì—”í‹°í‹°ì— ìƒë‹¹í•œ ì¤‘ë³µì´ ìˆìŠµë‹ˆë‹¤.
- **ê°•í•œ ì˜ì¡´ì„±**: `CBT-back-diary`ì˜ `Diary` ì—”í‹°í‹°ëŠ” `User` ì—”í‹°í‹°ì— ê°•í•œ ì˜ì¡´ì„±ì„ ê°€ì§‘ë‹ˆë‹¤ (ì™¸ë˜ í‚¤ `user_id`).
- **ê¸°ëŠ¥ í™•ì¥**: Auth-Serverë„ `Diary` ì—”í‹°í‹°, `Report` ì—”í‹°í‹°, `DiaryReportLink`ë¥¼ í¬í•¨í•˜ê³  ìˆì–´ ê¸°ë³¸ ì¸ì¦ì„ ë„˜ì–´ì„  ì¼ê¸° ê´€ë ¨ ê¸°ëŠ¥ì„ ì²˜ë¦¬í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŒì„ ì‹œì‚¬í•©ë‹ˆë‹¤.

### âš™ï¸ ì„œë¹„ìŠ¤ ê³„ì¸µ ê¸°ëŠ¥ì„±

```mermaid
graph TB
    subgraph "ğŸ” Auth-Server ì„œë¹„ìŠ¤"
        A[UserService<br/>í¬ê´„ì  ì‚¬ìš©ì ê´€ë¦¬]
        B[Oauth2Service<br/>OAuth2 í†µí•©]
        C[TokenService<br/>JWT ê´€ë¦¬]
        D[PrincipalDetailService<br/>Spring Security]
    end
    
    subgraph "ğŸ“š CBT-back-diary ì„œë¹„ìŠ¤"
        E[UserService<br/>ìµœì†Œí•œì˜ ì‚¬ìš©ì ì¡°íšŒ]
        F[DiaryService<br/>CRUD ì‘ì—…]
    end
    
    A --> C
    B --> C
    C --> D
    E --> F
    
    style A fill:#4caf50,color:#fff
    style B fill:#4caf50,color:#fff
    style C fill:#4caf50,color:#fff
    style D fill:#4caf50,color:#fff
    style E fill:#ff9800,color:#fff
    style F fill:#ff9800,color:#fff
```

- **Auth-Server**: OAuth2 í†µí•©, JWT ê´€ë¦¬, Spring Security í†µí•©ì„ í¬í•¨í•œ í¬ê´„ì ì¸ ì‚¬ìš©ì ê´€ë¦¬ ë° ì¸ì¦ ì‹œìŠ¤í…œì„ ë³´ìœ í•©ë‹ˆë‹¤.
- **CBT-back-diary**: í˜„ì¬ ìµœì†Œí•œì˜ `UserService`ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, ì£¼ë¡œ (ëª¨ì˜) ì‚¬ìš©ì ì„¸ë¶€ ì •ë³´ ê²€ìƒ‰ì— ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.

### ğŸ—„ï¸ ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ

| í”„ë¡œì íŠ¸ | ê¸°ìˆ  ìŠ¤íƒ | íŠ¹ì§• |
|----------|-----------|------|
| ğŸ” **Auth-Server** | QueryDSL + Spring Data JPA | ë³µì¡í•œ ì‚¬ìš©ì ê´€ë¦¬ë¥¼ ìœ„í•œ ì»¤ìŠ¤í…€ ì¿¼ë¦¬ |
| ğŸ“š **CBT-back-diary** | Spring Data JPA + JPQL | íŒŒìƒ ì¿¼ë¦¬ ë° JPQL ì˜ì¡´ |

### ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ ë° ì˜ì¡´ì„±

```mermaid
graph LR
    subgraph "ğŸ” Auth-Server"
        A[Java 21]
        B[Spring Boot 3.2.4]
        C[QueryDSL]
        D[Redis]
        E[JWT]
    end
    
    subgraph "ğŸ“š CBT-back-diary"
        F[Java 17]
        G[Spring Boot 3.2.0]
        H[ê¸°ë³¸ JPA]
        I[Redis ì—†ìŒ]
        J[JWT ì—†ìŒ]
    end
    
    style A fill:#ed8b00,color:#fff
    style B fill:#6db33f,color:#fff
    style C fill:#4DB33D,color:#fff
    style D fill:#DC382D,color:#fff
    style E fill:#000000,color:#fff
    style F fill:#ed8b00,color:#fff
    style G fill:#6db33f,color:#fff
    style H fill:#007acc,color:#fff
    style I fill:#cccccc,color:#000
    style J fill:#cccccc,color:#000
```

**ì£¼ìš” ì°¨ì´ì :**
- **Java ë²„ì „**: Auth-Server (Java 21) vs CBT-back-diary (Java 17)
- **Spring Boot**: Auth-Server (3.2.4) vs CBT-back-diary (3.2.0)
- **JPA ì„¤ì •**: Auth-Server (`ddl-auto: none`) vs CBT-back-diary (`ddl-auto: update`)

## 3. ğŸ” ì•„í‚¤í…ì²˜ ì ‘ê·¼ ë°©ì‹ í‰ê°€

### 3.1. ğŸ¢ ëª¨ë†€ë¦¬ìŠ¤ í†µí•©

```mermaid
graph TB
    subgraph "ğŸ”— í†µí•©ëœ ëª¨ë†€ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜"
        A[í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜]
        B[í†µí•©ëœ Auth-Server]
        C[ë‹¨ì¼ ë°ì´í„°ë² ì´ìŠ¤]
        D[ê³µìœ  ì„œë¹„ìŠ¤ ê³„ì¸µ]
    end
    
    A --> B
    B --> C
    B --> D
    D --> C
    
    style A fill:#61dafb,color:#000
    style B fill:#6db33f,color:#fff
    style C fill:#4479a1,color:#fff
    style D fill:#ff9800,color:#fff
```

#### âœ… ì¥ì 

| ğŸ’š ì¥ì  | ğŸ“ ì„¤ëª… |
|---------|---------|
| **ì¤‘ë³µ ì œê±°** | ì¤‘ë³µëœ `User`, `AuthProvider` ì—”í‹°í‹° ë° ì¤‘ë³µ ì‚¬ìš©ì ê´€ë¦¬ ë¡œì§ ì œê±° |
| **ë°ì´í„° ì¼ê´€ì„± ë‹¨ìˆœí™”** | ë‹¨ì¼ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ê°•ë ¥í•œ íŠ¸ëœì­ì…˜ ì¼ê´€ì„± ë³´ì¥ |
| **ì§€ì—° ì‹œê°„ ê°ì†Œ** | ì§ì ‘ ë©”ì„œë“œ í˜¸ì¶œë¡œ ì„œë¹„ìŠ¤ ê°„ API í˜¸ì¶œë³´ë‹¤ ë¹ ë¥¸ ì„±ëŠ¥ |
| **ê°œë°œ/ë°°í¬ ë‹¨ìˆœí™”** | ë‹¨ì¼ ì½”ë“œë² ì´ìŠ¤ë¡œ ê´€ë¦¬, ë¹Œë“œ, ë°°í¬ê°€ ìš©ì´ |
| **Auth-Server ê°•ì  í™œìš©** | ì„±ìˆ™í•œ ì¸ì¦, ê¶Œí•œ ë¶€ì—¬, JWT ê´€ë¦¬ ê¸°ëŠ¥ ì§ì ‘ í™œìš© |
| **ì›ìì  íŠ¸ëœì­ì…˜** | ì‚¬ìš©ìì™€ ì¼ê¸° ë°ì´í„°ë¥¼ ë‹¨ì¼ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬ |

#### âŒ ë‹¨ì 

| ğŸ”´ ë‹¨ì  | ğŸ“ ì„¤ëª… |
|---------|---------|
| **ê¸°ìˆ  í†µí•© ë…¸ë ¥** | Java ë²„ì „ í†µì¼, Spring Boot ë²„ì „ ì •ë ¬ í•„ìš” |
| **ì• í”Œë¦¬ì¼€ì´ì…˜ ë³µì¡ì„± ì¦ê°€** | ë” í¬ê³  ë³µì¡í•œ ëª¨ë†€ë¦¬ìŠ¤ë¡œ ì¸í•œ ë¹Œë“œ ì‹œê°„ ì¦ê°€ |
| **í™•ì¥ì„± ë„ì „** | íŠ¹ì • ë¶€ë¶„ì˜ ë…ë¦½ì  í™•ì¥ ì–´ë ¤ì›€ |
| **ë°°í¬ ê²½ì§ì„±** | ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ë°°í¬ í•„ìš” |
| **CBT-back-diary ë‹¨ìˆœì„± ì†ì‹¤** | ê°„ë‹¨í•œ ì„œë¹„ìŠ¤ê°€ ë³µì¡í•œ ì‹œìŠ¤í…œì— í†µí•©ë¨ |

### 3.2. ğŸ”— ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë¶„ë¦¬

```mermaid
graph TB
    subgraph "ğŸŒ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜"
        A[í´ë¼ì´ì–¸íŠ¸]
        B[Auth-Server]
        C[CBT-back-diary]
        D[Auth DB]
        E[Diary DB]
        F[API Gateway]
    end
    
    A --> F
    F --> B
    F --> C
    B --> D
    C --> E
    B <--> C
    
    style A fill:#61dafb,color:#000
    style B fill:#6db33f,color:#fff
    style C fill:#ff9800,color:#fff
    style D fill:#4479a1,color:#fff
    style E fill:#4479a1,color:#fff
    style F fill:#9c27b0,color:#fff
```

#### âœ… ì¥ì 

| ğŸ’š ì¥ì  | ğŸ“ ì„¤ëª… |
|---------|---------|
| **ê´€ì‹¬ì‚¬ ë¶„ë¦¬** | ì¸ì¦/ì‚¬ìš©ì ê´€ë¦¬ì™€ ì¼ê¸° ê¸°ëŠ¥ ê°„ ëª…í™•í•œ ê²½ê³„ |
| **ë…ë¦½ì  ê°œë°œ/ë°°í¬** | ê° ì„œë¹„ìŠ¤ì˜ ë…ë¦½ì  ì—…ë°ì´íŠ¸ ë° ë°°í¬ |
| **ê¸°ìˆ  ë‹¤ì–‘ì„±** | ì„œë¹„ìŠ¤ë³„ íŠ¹í™”ëœ ê¸°ìˆ  ìŠ¤íƒ ì„ íƒ ê°€ëŠ¥ |
| **ë…ë¦½ì  í™•ì¥ì„±** | ê° ì„œë¹„ìŠ¤ì˜ ë¡œë“œ ìš”êµ¬ì‚¬í•­ì— ë”°ë¥¸ ê°œë³„ í™•ì¥ |
| **ì¥ì•  ê²©ë¦¬** | í•œ ì„œë¹„ìŠ¤ì˜ ë¬¸ì œê°€ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ìµœì†Œí™” |

#### âŒ ë‹¨ì 

| ğŸ”´ ë‹¨ì  | ğŸ“ ì„¤ëª… |
|---------|---------|
| **ì„œë¹„ìŠ¤ ê°„ í†µì‹  ì˜¤ë²„í—¤ë“œ** | API í˜¸ì¶œë¡œ ì¸í•œ ë„¤íŠ¸ì›Œí¬ ì§€ì—° ë° ë³µì¡ì„± |
| **ë°ì´í„° ì¼ê´€ì„± ë„ì „** | ì—¬ëŸ¬ ì„œë¹„ìŠ¤ ê°„ ë°ì´í„° ë™ê¸°í™” ë³µì¡ì„± |
| **ì¤‘ë³µëœ ëª¨ë¸/DTO** | ì‚¬ìš©ì ì •ë³´ì˜ ì¤‘ë³µ í‘œí˜„ í•„ìš” |
| **ë¶„ì‚° íŠ¸ëœì­ì…˜** | ì—¬ëŸ¬ ì„œë¹„ìŠ¤ì— ê±¸ì¹œ íŠ¸ëœì­ì…˜ ê´€ë¦¬ ë³µì¡ì„± |
| **ìš´ì˜ ë³µì¡ì„±** | ì—¬ëŸ¬ ì„œë¹„ìŠ¤ ê´€ë¦¬, ëª¨ë‹ˆí„°ë§, ë””ë²„ê¹…ì˜ ë³µì¡ì„± |

## 4. ğŸ’¡ ê¶Œì¥ì‚¬í•­

```mermaid
graph TB
    A[í˜„ì¬ ìƒí™© ë¶„ì„] --> B{ë°ì´í„° ê²°í•©ë„ í‰ê°€}
    B -->|ë†’ìŒ| C[ëª¨ë†€ë¦¬ìŠ¤ í†µí•© ê¶Œì¥]
    B -->|ë‚®ìŒ| D[ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë¶„ë¦¬]
    C --> E[Auth-Server ê¸°ë°˜ í†µí•©]
    
    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#e8f5e8
    style D fill:#ffebee
    style E fill:#f3e5f5
```

**ğŸ¯ ê¶Œì¥ì‚¬í•­: Auth-Serverë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ëª¨ë†€ë¦¬ìŠ¤ í†µí•©**

### ğŸ” ê·¼ê±°

1. **ğŸ”— ê°•í•œ ë°ì´í„° ê²°í•©ë„**: `CBT-back-diary`ì˜ `Diary` ê¸°ëŠ¥ì€ ë³¸ì§ˆì ìœ¼ë¡œ `User` ì—”í‹°í‹°ì™€ ë°€ì ‘í•˜ê²Œ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

2. **ğŸ“ˆ ìš´ì˜ ë‹¨ìˆœì„±**: í˜„ì¬ íŒ€ ê·œëª¨ì™€ ìš´ì˜ ì—­ëŸ‰ì„ ê³ ë ¤í•  ë•Œ ëª¨ë†€ë¦¬ìŠ¤ê°€ ë” ì í•©í•©ë‹ˆë‹¤.

3. **ğŸ› ï¸ ê¸°ìˆ  ì„±ìˆ™ë„**: Auth-Serverì˜ ì„±ìˆ™í•œ ì¸ì¦ ë° ê¶Œí•œ ë¶€ì—¬ ì‹œìŠ¤í…œì„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

4. **âš¡ ì„±ëŠ¥ ìµœì í™”**: ë‹¨ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œì˜ ì§ì ‘ ë©”ì„œë“œ í˜¸ì¶œì´ API í˜¸ì¶œë³´ë‹¤ ë¹ ë¦…ë‹ˆë‹¤.

### ğŸ“‹ êµ¬í˜„ ë‹¨ê³„

```mermaid
gantt
    title í†µí•© êµ¬í˜„ ë¡œë“œë§µ
    dateFormat  YYYY-MM-DD
    section ì¤€ë¹„ ë‹¨ê³„
    ê¸°ìˆ  ìŠ¤íƒ ì •ë ¬        :prep1, 2025-06-15, 5d
    ë°ì´í„° ëª¨ë¸ í†µí•©       :prep2, after prep1, 7d
    section ê°œë°œ ë‹¨ê³„
    ì„œë¹„ìŠ¤ ê³„ì¸µ í†µí•©       :dev1, after prep2, 10d
    API ì—”ë“œí¬ì¸íŠ¸ í†µí•©    :dev2, after dev1, 7d
    section í…ŒìŠ¤íŠ¸ ë‹¨ê³„
    í†µí•© í…ŒìŠ¤íŠ¸           :test1, after dev2, 5d
    ì„±ëŠ¥ í…ŒìŠ¤íŠ¸           :test2, after test1, 3d
    section ë°°í¬ ë‹¨ê³„
    ìŠ¤í…Œì´ì§• ë°°í¬         :deploy1, after test2, 2d
    í”„ë¡œë•ì…˜ ë°°í¬         :deploy2, after deploy1, 1d
```

### ğŸš€ ë‹¤ìŒ ë‹¨ê³„

1. **ê¸°ìˆ  ìŠ¤íƒ í‘œì¤€í™”** (Java 21, Spring Boot 3.2.4)
2. **ì—”í‹°í‹° ëª¨ë¸ í†µí•©** ë° ì¤‘ë³µ ì œê±°
3. **ì„œë¹„ìŠ¤ ê³„ì¸µ í†µí•©** ë° ê¸°ëŠ¥ í†µí•©
4. **í…ŒìŠ¤íŠ¸ ì „ëµ** ìˆ˜ë¦½ ë° ì‹¤í–‰
5. **ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜** ê³„íš ìˆ˜ë¦½

---

> ğŸ’¡ **ì°¸ê³ **: ì´ ê¶Œì¥ì‚¬í•­ì€ í˜„ì¬ í”„ë¡œì íŠ¸ ìƒíƒœì™€ íŒ€ ì—­ëŸ‰ì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©°, í–¥í›„ í”„ë¡œì íŠ¸ ê·œëª¨ê°€ í™•ì¥ë˜ë©´ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œì˜ ë¶„í•´ë¥¼ ì¬ê³ ë ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
