## User Entity Comparison

| Feature          | Auth-Server                                      | CBT-back-diary                                     | Notes                                                                                                                                                                       |
|------------------|--------------------------------------------------|----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Table Name**   | `Users`                                          | `Users`                                            | Consistent.                                                                                                                                                                 |
| **Fields**       |                                                  |                                                    |                                                                                                                                                                             |
| `id`             | `Long`                                           | `Long`                                             |                                                                                                                                                                             |
|   JPA Annotations| `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)` | `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)`, `@Column(name = "id", updatable = false, nullable = false)` | `CBT-back-diary` explicitly defines `@Column` for `id`.                                                                                                                            |
|   Column Name    | `id` (implicit)                                  | `id`                                               | Consistent.                                                                                                                                                                 |
|   Nullable       | Default (true, but effectively false due to `@Id` and auto-increment) | `false`                                            | `CBT-back-diary` explicitly marks `nullable = false`.                                                                                                                         |
| `password`       | `String`                                         | `String`                                           |                                                                                                                                                                             |
|   JPA Annotations| `@Column(nullable = false)`                      | `@Column(name = "password", nullable = false)`     | `CBT-back-diary` explicitly defines `name`.                                                                                                                                   |
|   Column Name    | `password` (implicit)                            | `password`                                         | Consistent.                                                                                                                                                                 |
|   Nullable       | `false`                                          | `false`                                            | Consistent.                                                                                                                                                                 |
| `email`          | `String`                                         | `String`                                           |                                                                                                                                                                             |
|   JPA Annotations| `@Column(name = "email", nullable = false, length = 255, unique = true)` | `@Column(name = "email", unique = true, nullable = false)` | `Auth-Server` specifies `length = 255`.                                                                                                                                 |
|   Column Name    | `email`                                          | `email`                                            | Consistent.                                                                                                                                                                 |
|   Nullable       | `false`                                          | `false`                                            | Consistent.                                                                                                                                                                 |
|   Unique         | `true`                                           | `true`                                             | Consistent.                                                                                                                                                                 |
|   Length         | `255`                                            | Not specified (defaults to DB's max)             | `Auth-Server` has explicit length.                                                                                                                                          |
| `userName`       | `String`                                         | `String`                                           | Field name is `userName` in both.                                                                                                                                           |
|   JPA Annotations| `@Column(name = "user_name", nullable = false, length = 50, unique = true)` | `@Column(name = "user_name", unique = true, nullable = false, length = 50)` | Consistent. `CBT-back-diary` DTO mapping comment: "Maps to nickname in DTO".                                                                                                |
|   Column Name    | `user_name`                                      | `user_name`                                        | Consistent.                                                                                                                                                                 |
|   Nullable       | `false`                                          | `false`                                            | Consistent.                                                                                                                                                                 |
|   Unique         | `true`                                           | `true`                                             | Consistent.                                                                                                                                                                 |
|   Length         | `50`                                             | `50`                                               | Consistent.                                                                                                                                                                 |
| `createdAt`      | `LocalDateTime`                                  | `LocalDateTime`                                    |                                                                                                                                                                             |
|   JPA Annotations| `@Column(name = "created_at", nullable = false, updatable = false)` | `@Column(name = "created_at", updatable = false, nullable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP")` | `CBT-back-diary` uses `columnDefinition` for DB-level default. `Auth-Server` relies on `@PrePersist`.                                                                         |
|   Column Name    | `created_at`                                     | `created_at`                                       | Consistent.                                                                                                                                                                 |
|   Nullable       | `false`                                          | `false`                                            | Consistent.                                                                                                                                                                 |
|   Updatable      | `false`                                          | `false`                                            | Consistent.                                                                                                                                                                 |
|   Default        | Set by `@PrePersist` (`LocalDateTime.now()`)     | `@Builder.Default` (`LocalDateTime.now()`) and DB default `CURRENT_TIMESTAMP` | `CBT-back-diary` has both `@Builder.Default` for Java object creation and a DB default. `Auth-Server` uses `@PrePersist`.                                              |
| `updatedAt`      | `LocalDateTime`                                  | `LocalDateTime`                                    |                                                                                                                                                                             |
|   JPA Annotations| `@Column(name = "updated_at", nullable = false)` | `@Column(name = "updated_at", nullable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP")` | `CBT-back-diary` uses `columnDefinition` for DB-level default and auto-update. `Auth-Server` relies on `@PrePersist` and `@PreUpdate`.                                             |
|   Column Name    | `updated_at`                                     | `updated_at`                                       | Consistent.                                                                                                                                                                 |
|   Nullable       | `false`                                          | `false`                                            | Consistent.                                                                                                                                                                 |
|   Default        | Set by `@PrePersist` and `@PreUpdate` (`LocalDateTime.now()`) | `@Builder.Default` (`LocalDateTime.now()`) and DB default `CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | `CBT-back-diary` has `@Builder.Default` and DB default with auto-update. `Auth-Server` uses lifecycle callbacks.                                                             |
| `lastLogin`      | `LocalDateTime`                                  | `LocalDateTime`                                    |                                                                                                                                                                             |
|   JPA Annotations| `@Column(name = "last_login")`                   | `@Column(name = "last_login")`                     | Consistent.                                                                                                                                                                 |
|   Column Name    | `last_login`                                     | `last_login`                                       | Consistent.                                                                                                                                                                 |
|   Nullable       | `true` (default)                                 | `true` (default)                                   | Consistent.                                                                                                                                                                 |
| `userRole`       | `String`                                         | `String`                                           |                                                                                                                                                                             |
|   JPA Annotations| `@Column(name = "user_role", nullable = false, length = 20)` | `@Column(name = "user_role", nullable = false, length = 20)` | Consistent. `CBT-back-diary` DTO mapping comment: "Maps to role in DTO".                                                                                                    |
|   Column Name    | `user_role`                                      | `user_role`                                        | Consistent.                                                                                                                                                                 |
|   Nullable       | `false`                                          | `false`                                            | Consistent.                                                                                                                                                                 |
|   Length         | `20`                                             | `20`                                               | Consistent.                                                                                                                                                                 |
|   Default        | `@Builder.Default` (`"USER"`)                    | Not specified (relies on application logic or DTO default) | `Auth-Server` initializes with `"USER"`. `CBT-back-diary` does not specify a default here, but its `@Builder` annotation on the class implies it might be set during object creation if not provided. |
| `isPremium`      | `Boolean`                                        | `boolean`                                          | `Auth-Server` uses wrapper `Boolean`, `CBT-back-diary` uses primitive `boolean`.                                                                                              |
|   JPA Annotations| `@Column(name = "is_premium", nullable = false)` | `@Column(name = "is_premium", nullable = false)`   | Consistent.                                                                                                                                                                 |
|   Column Name    | `is_premium`                                     | `is_premium`                                       | Consistent.                                                                                                                                                                 |
|   Nullable       | `false`                                          | `false` (primitive default is `false`)             | Effectively consistent.                                                                                                                                                     |
|   Default        | `@Builder.Default` (`false`)                     | `@Builder.Default` (`false`)                       | Consistent.                                                                                                                                                                 |
| `isActive`       | `String`                                         | `String`                                           |                                                                                                                                                                             |
|   JPA Annotations| `@Column(name = "is_active", nullable = false, length = 20)` | `@Column(name = "is_active", nullable = false, length = 20)` | Consistent.                                                                                                                                                                 |
|   Column Name    | `is_active`                                      | `is_active`                                        | Consistent.                                                                                                                                                                 |
|   Nullable       | `false`                                          | `false`                                            | Consistent.                                                                                                                                                                 |
|   Length         | `20`                                             | `20`                                               | Consistent.                                                                                                                                                                 |
|   Default        | `@Builder.Default` (`"ACTIVE"`)                  | `@Builder.Default` (`"ACTIVE"`)                    | Consistent.                                                                                                                                                                 |
| **Relationships**|                                                  |                                                    |                                                                                                                                                                             |
| `diaries`        | `List<Diary>`                                    | Not present                                        | `Auth-Server` has a OneToMany relationship with `Diary`.                                                                                                                      |
|   JPA Annotations| `@OneToMany(mappedBy = "user")`                  | N/A                                                |                                                                                                                                                                             |
|   Default        | `@Builder.Default` (`new ArrayList<>()`)         | N/A                                                |                                                                                                                                                                             |
| `authentications`| `List<UserAuthentication>`                       | Not present                                        | `Auth-Server` has a OneToMany relationship with `UserAuthentication`.                                                                                                       |
|   JPA Annotations| `@OneToMany(mappedBy = "user", cascade = CascadeType.ALL, orphanRemoval = true)` | N/A                                                |                                                                                                                                                                             |
|   Default        | `@Builder.Default` (`new ArrayList<>()`)         | N/A                                                |                                                                                                                                                                             |
| `customSettings` | `List<UserCustomSetting>`                        | Not present                                        | `Auth-Server` has a OneToMany relationship with `UserCustomSetting`.                                                                                                        |
|   JPA Annotations| `@OneToMany(mappedBy = "user", cascade = CascadeType.ALL, orphanRemoval = true)` | N/A                                                |                                                                                                                                                                             |
|   Default        | `@Builder.Default` (`new ArrayList<>()`)         | N/A                                                |                                                                                                                                                                             |
| **Lifecycle Callbacks** |                                          |                                                    |                                                                                                                                                                             |
| `@PrePersist`    | `onCreate()`: sets `createdAt`, `updatedAt`      | `onCreate()`: sets `createdAt`, `updatedAt` (if null, though `@Builder.Default` should handle this) | Both use `@PrePersist`. `Auth-Server`'s implementation is more direct. `CBT-back-diary` has null checks that might be redundant due to `@Builder.Default` and DB defaults. |
| `@PreUpdate`     | `onUpdate()`: sets `updatedAt`                   | `onUpdate()`: sets `updatedAt`                     | Both use `@PreUpdate`.                                                                                                                                                      |
| **Helper Methods** | None specific to DTO mapping                     | `getNickname()`, `getRole()`                       | `CBT-back-diary` has explicit getters for mapping `userName` to `nickname` and `userRole` to `role` in DTOs.                                                                    |

### User Entity Differences Summary

*   **Relationships:** The most significant difference is that `Auth-Server:User` has relationships to `Diary`, `UserAuthentication`, and `UserCustomSetting` (`@OneToMany`), while `CBT-back-diary:User` does not define these relationships.
*   **Default Values:**
    *   `createdAt` and `updatedAt`: `Auth-Server` relies purely on `@PrePersist` and `@PreUpdate` for setting these timestamps. `CBT-back-diary` uses a combination of `@Builder.Default` (for Java object initialization), and `columnDefinition` for database-level defaults (`DEFAULT CURRENT_TIMESTAMP` and `ON UPDATE CURRENT_TIMESTAMP`). This makes `CBT-back-diary`'s approach more robust if entities are created/updated outside of JPA's lifecycle management (e.g., direct SQL).
    *   `userRole`: `Auth-Server` sets a default of `"USER"` using `@Builder.Default`. `CBT-back-diary` does not specify a default for `userRole` in the entity, potentially relying on application logic or DTOs to set this.
*   **Data Types:** `isPremium` is `Boolean` (wrapper) in `Auth-Server` and `boolean` (primitive) in `CBT-back-diary`.
*   **Explicit Column Definition for `id`:** `CBT-back-diary` explicitly adds `@Column(name = "id", updatable = false, nullable = false)` for the `id` field, while `Auth-Server` relies on JPA defaults for `@Id`.
*   **Email Length:** `Auth-Server` specifies `length = 255` for the `email` field, while `CBT-back-diary` does not.
*   **Lifecycle Callbacks (`@PrePersist`, `@PreUpdate`):** Both entities use these callbacks. `Auth-Server`'s implementation is straightforward. `CBT-back-diary`'s `onCreate` has null checks that might be redundant given the use of `@Builder.Default` and database defaults.
*   **Helper Methods:** `CBT-back-diary` includes `getNickname()` and `getRole()` methods, likely for DTO mapping, which are not present in `Auth-Server`.
*   **Lombok Annotations:** Both use `@Data`, `@Builder`, `@NoArgsConstructor`, `@AllArgsConstructor`, `@Entity`, `@Table`.

## AuthProvider Entity Comparison

| Feature             | Auth-Server                                      | CBT-back-diary                                       | Notes                                                                                             |
|---------------------|--------------------------------------------------|------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| **Table Name**      | `Auth_Provider`                                  | `Auth_Provider`                                      | Consistent.                                                                                       |
| **Fields**          |                                                  |                                                      |                                                                                                   |
| `id`                | `Integer`                                        | `Integer`                                            | Consistent data type.                                                                             |
|   JPA Annotations   | `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)` | `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)`, `@Column(name = "id", updatable = false, nullable = false)` | `CBT-back-diary` explicitly defines `@Column` for `id`.                                           |
|   Column Name       | `id` (implicit)                                  | `id`                                                 | Consistent.                                                                                       |
|   Nullable          | Default (true, but effectively false due to `@Id` and auto-increment) | `false`                                              | `CBT-back-diary` explicitly marks `nullable = false`.                                               |
| `providerName`      | `String`                                         | `String`                                             |                                                                                                   |
|   JPA Annotations   | `@Column(name = "provider_name", nullable = false, length = 50, unique = true)` | `@Column(name = "provider_name", unique = true, nullable = false, length = 50)` | Consistent. `CBT-back-diary` has a comment: "// e.g., "server", "google", "kakao"".             |
|   Column Name       | `provider_name`                                  | `provider_name`                                      | Consistent.                                                                                       |
|   Nullable          | `false`                                          | `false`                                              | Consistent.                                                                                       |
|   Unique            | `true`                                           | `true`                                               | Consistent.                                                                                       |
|   Length            | `50`                                             | `50`                                                 | Consistent.                                                                                       |
| `description`       | `String`                                         | `String`                                             |                                                                                                   |
|   JPA Annotations   | `@Column(nullable = true)`                       | `@Column(name = "description")`                      | `Auth-Server` explicitly sets `nullable = true`. `CBT-back-diary` implies nullable by not setting `nullable = false`. |
|   Column Name       | `description` (implicit)                         | `description`                                        | Consistent.                                                                                       |
|   Nullable          | `true`                                           | `true` (default)                                     | Consistent.                                                                                       |
| `isActive`          | `Boolean`                                        | `boolean`                                            | `Auth-Server` uses wrapper `Boolean`, `CBT-back-diary` uses primitive `boolean`.                  |
|   JPA Annotations   | `@Column(name = "is_active", nullable = false)`  | `@Column(name = "is_active", nullable = false)`      | Consistent.                                                                                       |
|   Column Name       | `is_active`                                      | `is_active`                                          | Consistent.                                                                                       |
|   Nullable          | `false`                                          | `false` (primitive default is `false`)               | Effectively consistent.                                                                           |
|   Default           | `@Builder.Default` (`true`)                      | `@Builder.Default` (`true`)                          | Consistent.                                                                                       |
| **Relationships**   |                                                  |                                                      |                                                                                                   |
| `userAuthentications` | `List<UserAuthentication>`                     | Not present                                          | `Auth-Server` has a OneToMany relationship with `UserAuthentication`.                             |
|   JPA Annotations   | `@OneToMany(mappedBy = "authProvider", cascade = CascadeType.ALL)` | N/A                                                  |                                                                                                   |
|   Default           | `@Builder.Default` (`new ArrayList<>()`)         | N/A                                                  |                                                                                                   |
| **Lombok Annotations** | `@Data`, `@NoArgsConstructor`, `@AllArgsConstructor`, `@Builder`, `@Entity`, `@Table` | `@Data`, `@Builder`, `@NoArgsConstructor`, `@AllArgsConstructor`, `@Entity`, `@Table` | Consistent. |

### AuthProvider Entity Differences Summary

*   **Relationships:** `Auth-Server:AuthProvider` has a `@OneToMany` relationship with `UserAuthentication` (`userAuthentications` field), which is absent in `CBT-back-diary:AuthProvider`. This indicates `Auth-Server` directly links providers to their associated user authentication records.
*   **Data Types:** `isActive` is `Boolean` (wrapper) in `Auth-Server` and `boolean` (primitive) in `CBT-back-diary`.
*   **Explicit Column Definition for `id`:** Similar to the `User` entity, `CBT-back-diary` explicitly defines `@Column(name = "id", updatable = false, nullable = false)` for its `id` field.
*   **`description` Nullability:** `Auth-Server` explicitly states `nullable = true` for `description`, while `CBT-back-diary` implies it by default. The behavior is the same.

The core fields (`id`, `providerName`, `description`, `isActive`) are very similar in terms of definition and constraints. The main divergence is the `userAuthentications` relationship in `Auth-Server`.

## Diary Entity Comparison

| Feature                | Auth-Server                                      | CBT-back-diary                                       | Notes                                                                                                                                                                                             |
|------------------------|--------------------------------------------------|------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Table Name**         | `Diary`                                          | `Diary`                                              | Consistent.                                                                                                                                                                                       |
| **Lombok Annotations** | `@Data`, `@NoArgsConstructor`, `@AllArgsConstructor`, `@Entity`, `@Table` | `@Data`, `@Builder`, `@NoArgsConstructor`, `@AllArgsConstructor`, `@Entity`, `@Table` | `CBT-back-diary` includes `@Builder`.                                                                                                                                                               |
| **Fields**             |                                                  |                                                      |                                                                                                                                                                                                   |
| `id`                   | `Long`                                           | `Long`                                               | Consistent.                                                                                                                                                                                       |
|   JPA Annotations      | `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)` | `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)`, `@Column(name = "id", updatable = false, nullable = false)` | `CBT-back-diary` explicitly defines `@Column` for `id`.                                                                                                                                             |
|   Column Name          | `id` (implicit)                                  | `id`                                                 | Consistent.                                                                                                                                                                                       |
| `user`                 | `User`                                           | `User`                                               | Represents the owning user.                                                                                                                                                                       |
|   JPA Annotations      | `@ManyToOne(fetch = FetchType.LAZY)`, `@JoinColumn(name = "user_id", nullable = false)` | `@ManyToOne(fetch = FetchType.LAZY)`, `@JoinColumn(name = "user_id", nullable = false)` | Consistent. Both use lazy fetching.                                                                                                                                                               |
|   Column Name          | `user_id`                                        | `user_id`                                            | Consistent.                                                                                                                                                                                       |
|   Nullable             | `false`                                          | `false`                                              | Consistent.                                                                                                                                                                                       |
| `createdAt`            | `LocalDateTime`                                  | `LocalDateTime`                                      |                                                                                                                                                                                                   |
|   JPA Annotations      | `@Column(name = "created_at", nullable = false)` | `@Column(name = "created_at", updatable = false, nullable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP")` | `CBT-back-diary` adds `updatable = false` and DB default. `Auth-Server` sets via `@PrePersist`.                                                                                                     |
|   Column Name          | `created_at`                                     | `created_at`                                         | Consistent.                                                                                                                                                                                       |
|   Nullable             | `false`                                          | `false`                                              | Consistent.                                                                                                                                                                                       |
|   Default              | Set by `@PrePersist` (`LocalDateTime.now()`)     | `@Builder.Default` (`LocalDateTime.now()`) and DB default `CURRENT_TIMESTAMP` | `CBT-back-diary` uses `@Builder.Default` and DB default. `Auth-Server` uses `@PrePersist`.                                                                                                     |
| `updatedAt`            | `LocalDateTime`                                  | `LocalDateTime`                                      |                                                                                                                                                                                                   |
|   JPA Annotations      | `@Column(name = "updated_at", nullable = false)` | `@Column(name = "updated_at", nullable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP")` | `CBT-back-diary` adds DB default and auto-update. `Auth-Server` sets via `@PrePersist` and `@PreUpdate`.                                                                                      |
|   Column Name          | `updated_at`                                     | `updated_at`                                         | Consistent.                                                                                                                                                                                       |
|   Nullable             | `false`                                          | `false`                                              | Consistent.                                                                                                                                                                                       |
|   Default              | Set by `@PrePersist` and `@PreUpdate` (`LocalDateTime.now()`) | `@Builder.Default` (`LocalDateTime.now()`) and DB default `CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | `CBT-back-diary` uses `@Builder.Default` and DB default. `Auth-Server` uses lifecycle callbacks.                                                                                                |
| `title`                | `String`                                         | `String`                                             |                                                                                                                                                                                                   |
|   JPA Annotations      | `@Column(length = 255, nullable = true)`         | `@Column(name = "title", length = 255)`              | `Auth-Server` explicitly sets `nullable = true`. `CBT-back-diary` implies nullable by default for `title` (SQL allows NULL).                                                                          |
|   Column Name          | `title` (implicit)                               | `title`                                              | Consistent.                                                                                                                                                                                       |
|   Nullable             | `true`                                           | `true` (default, matches SQL)                        | Consistent.                                                                                                                                                                                       |
|   Length               | `255`                                            | `255`                                                | Consistent.                                                                                                                                                                                       |
| `content`              | `String`                                         | `String`                                             |                                                                                                                                                                                                   |
|   JPA Annotations      | `@Column(nullable = false, columnDefinition = "TEXT")` | `@Lob`, `@Column(name = "content", nullable = false, columnDefinition = "TEXT")` | `CBT-back-diary` adds `@Lob`. Both use `columnDefinition = "TEXT"`.                                                                                                                                 |
|   Column Name          | `content` (implicit)                             | `content`                                            | Consistent.                                                                                                                                                                                       |
|   Nullable             | `false`                                          | `false`                                              | Consistent.                                                                                                                                                                                       |
| `alternativeThought` / `aiAlternativeThoughts` | `String`                                         | `String`                                             | Field name differs: `alternativeThought` vs `aiAlternativeThoughts`.                                                                                                                              |
|   JPA Annotations      | `@Column(name = "alternative_thought", columnDefinition = "TEXT", nullable = true)` | `@Lob`, `@Column(name = "alternative_thought", columnDefinition = "TEXT")` | `CBT-back-diary` uses `@Lob` and its column name is `alternative_thought` (matching DB). `Auth-Server` also uses `alternative_thought` as column name and `nullable = true`. `CBT-back-diary` implies nullable. |
|   Column Name          | `alternative_thought`                            | `alternative_thought`                                | Column name is consistent (`alternative_thought`).                                                                                                                                                |
|   Nullable             | `true`                                           | `true` (default, matches SQL)                        | Consistent.                                                                                                                                                                                       |
| `isNegative`           | `Boolean`                                        | `Boolean`                                            | Wrapper `Boolean` used in both to allow nulls if DB permits.                                                                                                                                       |
|   JPA Annotations      | `@Column(name = "is_negative", nullable = false)` | `@Column(name = "is_negative")`                      | `Auth-Server` specifies `nullable = false` and a default. `CBT-back-diary` implies nullable (SQL allows NULL for `is_negative`).                                                                   |
|   Column Name          | `is_negative`                                    | `is_negative`                                        | Consistent.                                                                                                                                                                                       |
|   Nullable             | `false`                                          | `true` (default, matches SQL)                        | `Auth-Server` is `false`, `CBT-back-diary` allows `null`.                                                                                                                                         |
|   Default              | `= false` (Java init)                            | Not specified (relies on DB default or application logic) | `Auth-Server` initializes to `false`. `CBT-back-diary` doesn't specify Java default; DB default is `NULL`.                                                                                         |
| `diaryDate`            | Not present                                      | `LocalDate`                                          | `CBT-back-diary` has a `diaryDate` field of type `LocalDate`.                                                                                                                                   |
|   JPA Annotations      | N/A                                              | `@Column(name = "diary_date", nullable = false)`     |                                                                                                                                                                                                   |
|   Column Name          | N/A                                              | `diary_date`                                         |                                                                                                                                                                                                   |
|   Nullable             | N/A                                              | `false`                                              |                                                                                                                                                                                                   |
| **Lifecycle Callbacks**|                                                  |                                                      |                                                                                                                                                                                                   |
| `@PrePersist`          | `onCreate()`: sets `createdAt`, `updatedAt`      | `onCreate()`: sets `createdAt`, `updatedAt` (if null) | Both use `@PrePersist`. `CBT-back-diary` has null checks which might be redundant due to `@Builder.Default` and DB defaults.                                                                      |
| `@PreUpdate`           | `onUpdate()`: sets `updatedAt`                   | `onUpdate()`: sets `updatedAt`                       | Both use `@PreUpdate`.                                                                                                                                                                            |
| **Helper Methods**     | None                                             | `getStringId()`                                      | `CBT-back-diary` has `getStringId()` for DTO mapping.                                                                                                                                           |

### Diary Entity Differences Summary

*   **`diaryDate` Field:** `CBT-back-diary:Diary` has an additional field `diaryDate` of type `LocalDate` (column `diary_date`, `nullable = false`). This field is not present in `Auth-Server:Diary`.
*   **Field Name for Thoughts:** The field for alternative thoughts is named `alternativeThought` in `Auth-Server` and `aiAlternativeThoughts` in `CBT-back-diary`. However, both map to the same database column `alternative_thought`.
*   **`isNegative` Nullability and Default:**
    *   `Auth-Server`: `isNegative` is `nullable = false` and has a Java default initializer `= false`.
    *   `CBT-back-diary`: `isNegative` is nullable (JPA default, matching the provided SQL schema where `is_negative` can be `NULL`). It does not have a Java default initializer in the field declaration.
*   **`@Lob` Annotation:** `CBT-back-diary` uses `@Lob` on `content` and `aiAlternativeThoughts` fields. `Auth-Server` does not use `@Lob` but uses `columnDefinition = "TEXT"` which generally serves the same purpose for text types.
*   **Timestamp Handling (`createdAt`, `updatedAt`):**
    *   `Auth-Server` relies on `@PrePersist` and `@PreUpdate` for setting timestamps.
    *   `CBT-back-diary` uses `@Builder.Default` for Java initialization and database-level defaults (`DEFAULT CURRENT_TIMESTAMP`, `ON UPDATE CURRENT_TIMESTAMP`) via `columnDefinition`. `CBT-back-diary` also has `updatable = false` on `createdAt`.
*   **`title` Nullability:** `Auth-Server` explicitly sets `nullable = true` for `title`. `CBT-back-diary`'s `title` is nullable by default (matching its database schema).
*   **Lombok `@Builder`:** `CBT-back-diary:Diary` includes `@Builder`, while `Auth-Server:Diary` does not (though its `User` entity did).
*   **Explicit Column Definition for `id`:** `CBT-back-diary` explicitly defines `@Column` for `id`.
*   **Helper Methods:** `CBT-back-diary` has a `getStringId()` helper method.

The core structure related to user, title, content, and thoughts is similar, but `CBT-back-diary` includes the `diaryDate` and has differences in nullability, defaults, and timestamp management strategies.

## UserAuthentication Entity Comparison

| Feature                | Auth-Server                                      | CBT-back-diary                                       | Notes                                                                                                                                                                                                                            |
|------------------------|--------------------------------------------------|------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Table Name**         | `User_Authentication`                            | `User_Authentication`                                | Consistent.                                                                                                                                                                                                                      |
| **Composite Key Strategy**| `@EmbeddedId` with external `UserAuthenticationId` class | `@IdClass` with inner `UserAuthenticationId` class   | Different JPA strategies for composite keys. `Auth-Server` uses `@EmbeddedId` and `CBT-back-diary` uses `@IdClass`.                                                                                                     |
|   `UserAuthenticationId` Class | Defined in `UserAuthenticationId.java`           | Defined as an inner class in `UserAuthentication.java` | `Auth-Server`: `public class UserAuthenticationId implements Serializable { private Long userId; private Integer authProviderId; ... }`. `CBT-back-diary`: `class UserAuthenticationId implements Serializable { private Long user; private Integer authProvider; ... }`. Field names within ID class differ (`userId` vs `user`, `authProviderId` vs `authProvider`). |
| **Fields**             |                                                  |                                                      |                                                                                                                                                                                                                                  |
| `id` (EmbeddedId)      | `UserAuthenticationId`                           | N/A (uses `@IdClass`)                                | `Auth-Server` has a single field `id` of type `UserAuthenticationId`.                                                                                                                                                            |
|   JPA Annotations      | `@EmbeddedId`                                    | N/A                                                  |                                                                                                                                                                                                                                  |
| `user` (Part of PK)    | `User`                                           | `User`                                               | Represents the user in the composite key.                                                                                                                                                                                        |
|   JPA Annotations      | `@ManyToOne(fetch = FetchType.LAZY)`, `@MapsId("userId")`, `@JoinColumn(name = "user_id")` | `@Id`, `@ManyToOne(fetch = FetchType.LAZY)`, `@JoinColumn(name = "user_id", referencedColumnName = "id", nullable = false)` | `Auth-Server` uses `@MapsId` to map `userId` from the `EmbeddedId` to this relationship. `CBT-back-diary` uses `@Id` on this field directly as part of `@IdClass` strategy and specifies `referencedColumnName`. |
|   Column Name in Join  | `user_id`                                        | `user_id`                                            | Consistent.                                                                                                                                                                                                                      |
| `authProvider` (Part of PK) | `AuthProvider`                               | `AuthProvider`                                       | Represents the auth provider in the composite key.                                                                                                                                                                               |
|   JPA Annotations      | `@ManyToOne(fetch = FetchType.LAZY)`, `@MapsId("authProviderId")`, `@JoinColumn(name = "auth_provider_id")` | `@Id`, `@ManyToOne(fetch = FetchType.LAZY)`, `@JoinColumn(name = "auth_provider_id", referencedColumnName = "id", nullable = false)` | `Auth-Server` uses `@MapsId` to map `authProviderId` from `EmbeddedId`. `CBT-back-diary` uses `@Id` on this field and specifies `referencedColumnName`.                                                      |
|   Column Name in Join  | `auth_provider_id`                               | `auth_provider_id`                                   | Consistent.                                                                                                                                                                                                                      |
| `socialId`             | `String`                                         | `String`                                             | Provider's unique ID for the user.                                                                                                                                                                                               |
|   JPA Annotations      | `@Column(name = "social_id", nullable = false, length = 255)` | `@Column(name = "social_id", nullable = false)`      | `Auth-Server` specifies `length = 255`.                                                                                                                                                                            |
|   Column Name          | `social_id`                                      | `social_id`                                          | Consistent.                                                                                                                                                                                                                      |
|   Nullable             | `false`                                          | `false`                                              | Consistent.                                                                                                                                                                                                                      |
|   Length               | `255`                                            | Not specified                                        | `Auth-Server` has explicit length.                                                                                                                                                                                               |
| `createdAt`            | `LocalDateTime`                                  | `LocalDateTime`                                      |                                                                                                                                                                                                                                  |
|   JPA Annotations      | `@Column(name = "created_at", nullable = false)` | `@Column(name = "created_at", updatable = false, nullable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP")` | `CBT-back-diary` adds `updatable = false` and DB default. `Auth-Server` uses `@PrePersist`.                                                                                                        |
|   Column Name          | `created_at`                                     | `created_at`                                         | Consistent.                                                                                                                                                                                                                      |
|   Nullable             | `false`                                          | `false`                                              | Consistent.                                                                                                                                                                                                                      |
|   Default              | Set by `@PrePersist` (`LocalDateTime.now()`)     | `@Builder.Default` (`LocalDateTime.now()`) and DB default `CURRENT_TIMESTAMP` | `CBT-back-diary` uses `@Builder.Default` and DB default. `Auth-Server` uses `@PrePersist`.                                                                                                        |
| `updatedAt`            | `LocalDateTime`                                  | `LocalDateTime`                                      |                                                                                                                                                                                                                                  |
|   JPA Annotations      | `@Column(name = "updated_at", nullable = false)` | `@Column(name = "updated_at", nullable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP")` | `CBT-back-diary` adds DB default and auto-update. `Auth-Server` uses `@PrePersist` and `@PreUpdate`.                                                                                         |
|   Column Name          | `updated_at`                                     | `updated_at`                                         | Consistent.                                                                                                                                                                                                                      |
|   Nullable             | `false`                                          | `false`                                              | Consistent.                                                                                                                                                                                                                      |
|   Default              | Set by `@PrePersist` and `@PreUpdate` (`LocalDateTime.now()`) | `@Builder.Default` (`LocalDateTime.now()`) and DB default `CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP` | `CBT-back-diary` uses `@Builder.Default` and DB default. `Auth-Server` uses lifecycle callbacks.                                                                                                   |
| **Table Constraints**  | `@Table(uniqueConstraints = {@UniqueConstraint(columnNames = {"auth_provider_id", "social_id"})})` | None specified at `@Table` level (PK is `user_id`, `auth_provider_id`) | `Auth-Server` defines an additional unique constraint on `(auth_provider_id, social_id)`. `CBT-back-diary` relies on the composite primary key `(user_id, auth_provider_id)` for uniqueness of that pair, but `social_id` is not part of this PK level constraint. |
| **Lifecycle Callbacks**|                                                  |                                                      |                                                                                                                                                                                                                                  |
| `@PrePersist`          | `onCreate()`: sets `createdAt`, `updatedAt`      | `onCreate()`: sets `createdAt`, `updatedAt` (if null) | Both use `@PrePersist`. `CBT-back-diary` has null checks which might be redundant due to `@Builder.Default`.                                                                                                    |
| `@PreUpdate`           | `onUpdate()`: sets `updatedAt`                   | `onUpdate()`: sets `updatedAt`                       | Both use `@PreUpdate`.                                                                                                                                                                                                |
| **Lombok Annotations** | `@Data`, `@NoArgsConstructor`, `@AllArgsConstructor`, `@Builder`, `@Entity`, `@Table` | `@Data`, `@Builder`, `@NoArgsConstructor`, `@AllArgsConstructor`, `@Entity`, `@Table`, `@IdClass` | `CBT-back-diary` has `@IdClass`. `Auth-Server` has `@Embeddable` on its ID class.                                                                                                                                  |

### UserAuthentication Entity Differences Summary

*   **Composite Key Strategy:** This is the most significant difference.
    *   `Auth-Server` uses `@EmbeddedId` with an external `UserAuthenticationId` class that contains `userId` (Long) and `authProviderId` (Integer). The main entity then has fields `User user` and `AuthProvider authProvider` annotated with `@MapsId` to link these to the fields in the embedded ID.
    *   `CBT-back-diary` uses `@IdClass` pointing to an inner `UserAuthenticationId` class. The fields `User user` and `AuthProvider authProvider` in the main entity are directly annotated with `@Id`. The `UserAuthenticationId` class in `CBT-back-diary` has fields named `user` (Long) and `authProvider` (Integer).
*   **Field Names in ID Class:** The field names within the respective ID classes differ: `userId`/`authProviderId` in `Auth-Server`'s `UserAuthenticationId` vs. `user`/`authProvider` in `CBT-back-diary`'s `UserAuthenticationId`. The types, however, correspond to the primary key types of `User` (Long) and `AuthProvider` (Integer).
*   **`socialId` Length:** `Auth-Server` specifies `length = 255` for `socialId`. `CBT-back-diary` does not.
*   **Timestamp Handling (`createdAt`, `updatedAt`):**
    *   `Auth-Server` relies on `@PrePersist` and `@PreUpdate` for setting timestamps.
    *   `CBT-back-diary` uses `@Builder.Default` for Java initialization and database-level defaults (`DEFAULT CURRENT_TIMESTAMP`, `ON UPDATE CURRENT_TIMESTAMP`) via `columnDefinition`. It also specifies `updatable = false` for `createdAt`.
*   **Table-level Unique Constraints:** `Auth-Server` defines an additional `UNIQUE constraint` at the table level for the combination of `(auth_provider_id, social_id)`. `CBT-back-diary` does not explicitly define this at the `@Table` level; its primary key is `(user_id, auth_provider_id)`. The uniqueness of `social_id` per provider is thus enforced differently or might be an application-level concern in `CBT-back-diary` beyond the PK.
*   **`referencedColumnName`:** `CBT-back-diary` explicitly uses `referencedColumnName = "id"` in its `@JoinColumn` annotations for the composite key fields, which is good practice but often optional if the referenced column name is indeed `id`. `Auth-Server` does not specify this, relying on JPA defaults.

Both entities establish a many-to-many relationship between users and authentication providers, storing a unique social ID for each combination. The method of defining the composite primary key is the main architectural difference.

## Summary of Differences in Entity Relationship Definitions

*   **Direction of Relationships:** `Auth-Server` defines bidirectional relationships more frequently at the "one" side (e.g., `User` to `Diary`, `User` to `UserAuthentication`, `AuthProvider` to `UserAuthentication`) using `@OneToMany`. `CBT-back-diary` primarily defines the `@ManyToOne` side (e.g., `Diary` to `User`) and does not have corresponding `@OneToMany` collections in the `User` or `AuthProvider` entities for the common entities.
*   **Cascade Options:** `Auth-Server` makes more explicit use of `cascade = CascadeType.ALL` and `orphanRemoval = true` in its `@OneToMany` relationships (e.g., `User.authentications`, `User.customSettings`, `AuthProvider.userAuthentications`). This implies that operations like deleting a `User` will also delete their associated `UserAuthentication` and `UserCustomSetting` records. `CBT-back-diary` does not specify cascade options on the (absent) `@OneToMany` side for these common entities; cascade behavior would be determined by JPA defaults or operations on the owning side of `@ManyToOne` relationships (which typically don't cascade removals by default).
*   **Fetch Strategies:** Both projects consistently use `FetchType.LAZY` for `@ManyToOne` relationships in `Diary` and `UserAuthentication`, which is good practice. `@OneToMany` relationships in `Auth-Server` default to `FetchType.LAZY`.
*   **Initialization of Collections:** `Auth-Server` uses `@Builder.Default` to initialize collection-valued fields (e.g., `diaries`, `authentications` in `User`) with `new ArrayList<>()`. This is a good practice to avoid null pointer exceptions when accessing these collections before they are populated from the database. `CBT-back-diary` does not have these collections in its versions of `User` and `AuthProvider`.

## Unique Entities in `Auth-Server` and Their Inferred Responsibilities

Based on the file listing of `Auth-server/backend/src/main/java/com/authentication/auth/domain`:

1.  **`DiaryReportLink.java` (and `DiaryReportLinkId.java`)**
    *   **Inferred Responsibility:** This entity likely acts as a join table or an entity representing a link between a `Diary` and a `Report`. Given the name, it probably establishes a many-to-many relationship or a one-to-many relationship with additional properties between diaries and reports. It might be used to associate specific diary entries with generated analysis reports. `DiaryReportLinkId` would be its composite key class if it's a join table.

2.  **`EmailVerification.java`**
    *   **Inferred Responsibility:** This entity is likely responsible for managing email verification tokens or records. It would store information such as a user's email, a verification token/code, and an expiration timestamp for the token. Its purpose is to verify user email addresses during registration or email change processes.

3.  **`Report.java`**
    *   **Inferred Responsibility:** This entity likely represents an analysis report generated based on user data, possibly from `Diary` entries. Fields might include report content, generation date, type of report, and a link to the user it belongs to. It seems to be a core part of an analysis or feedback feature in `Auth-Server`.

4.  **`SettingsOption.java`**
    *   **Inferred Responsibility:** This entity probably defines available settings or preferences that users can customize. It might store key-value pairs for setting names, descriptions, possible values, and types. It acts as a lookup table for available settings in the system.

5.  **`UserCustomSetting.java` (and `UserCustomSettingId.java`)**
    *   **Inferred Responsibility:** This entity likely stores the specific values chosen by a user for various `SettingsOption`s. It would link a `User` to a `SettingsOption` and store the custom value set by that user. `UserCustomSettingId` would be its composite key class, likely combining `userId` and `settingsOptionId`. This allows for a flexible user preferences system. The `User` entity in `Auth-Server` already has a `@OneToMany` relationship to this entity.
