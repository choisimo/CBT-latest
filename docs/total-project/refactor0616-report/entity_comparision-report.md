# Entity Comparison Report

This report compares entities from the `Auth-Server` and `CBT-back-diary` projects.

## Entities with Same or Similar Names

| Feature             | User (Auth-Server)                                                                                                | User (CBT-back-diary)                                                                                                                                                              | Differences / Notes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ------------------- | ----------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Entity Name**     | `User`                                                                                                            | `User`                                                                                                                                                                             | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Project**         | Auth-Server                                                                                                       | CBT-back-diary                                                                                                                                                                     | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Purpose**         | Represents a user in the system.                                                                                  | Represents a user in the system.                                                                                                                                                   | Same fundamental purpose.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **Fields**          |                                                                                                                   |                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `id`                | `Long`, `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)`                                              | `Long`, `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)`, `@Column(name = "id", updatable = false, nullable = false)`                                                    | CBT-back-diary explicitly defines `@Column`. Both are identity generated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `password`          | `String`, `@Column(nullable = false)`                                                                             | `String`, `@Column(name = "password", nullable = false)`                                                                                                                           | CBT-back-diary explicitly names the column.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `email`             | `String`, `@Column(name = "email", nullable = false, length = 255, unique = true)`                                | `String`, `@Column(name = "email", unique = true, nullable = false)`                                                                                                               | Auth-Server specifies length 255.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| `userName`          | `String`, `@Column(name = "user_name", nullable = false, length = 50, unique = true)`                             | `String`, `@Column(name = "user_name", unique = true, nullable = false, length = 50)`                                                                                              | Same. In CBT-back-diary, maps to `nickname` in DTO.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `createdAt`         | `LocalDateTime`, `@Column(name = "created_at", nullable = false, updatable = false)`                               | `LocalDateTime`, `@Builder.Default`, `@Column(name = "created_at", updatable = false, nullable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP")` (default now) | CBT-back-diary uses `@Builder.Default` and `columnDefinition` for DB default. Auth-Server sets via `@PrePersist`.                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `updatedAt`         | `LocalDateTime`, `@Column(name = "updated_at", nullable = false)`                                                 | `LocalDateTime`, `@Builder.Default`, `@Column(name = "updated_at", nullable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP")` (default now) | CBT-back-diary uses `@Builder.Default` and `columnDefinition` for DB default & update. Auth-Server sets via `@PrePersist` and `@PreUpdate`.                                                                                                                                                                                                                                                                                                                                                                                            |
| `lastLogin`         | `LocalDateTime`, `@Column(name = "last_login")`                                                                   | `LocalDateTime`, `@Column(name = "last_login")`                                                                                                                                    | Same.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `userRole`          | `String`, `@Builder.Default` "USER", `@Column(name = "user_role", nullable = false, length = 20)`                   | `String`, `@Column(name = "user_role", nullable = false, length = 20)` (In DTO `role`)                                                                                             | Auth-Server has `@Builder.Default` "USER". CBT-back-diary does not specify a Java-level default but implies it would be set.                                                                                                                                                                                                                                                                                                                                                                                                     |
| `isPremium`         | `Boolean`, `@Builder.Default` false, `@Column(name = "is_premium", nullable = false)`                               | `boolean`, `@Builder.Default` false, `@Column(name = "is_premium", nullable = false)`                                                                                                | Auth-Server uses `Boolean` (object wrapper), CBT-back-diary uses `boolean` (primitive). Both default to `false`.                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `isActive`          | `String`, `@Builder.Default` "ACTIVE", `@Column(name = "is_active", nullable = false, length = 20)`                 | `String`, `@Builder.Default` "ACTIVE", `@Column(name = "is_active", nullable = false, length = 20)`                                                                                 | Same.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **Relationships**   |                                                                                                                   |                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `diaries`           | `List<Diary>`, `@OneToMany(mappedBy = "user")`                                                                     | Not present directly. Implied relationship via `Diary.user`.                                                                                                                       | Auth-Server defines the owning side of the relationship from User to Diary. CBT-back-diary implies it from Diary's perspective.                                                                                                                                                                                                                                                                                                                                                                                                      |
| `authentications`   | `List<UserAuthentication>`, `@OneToMany(mappedBy = "user", cascade = CascadeType.ALL, orphanRemoval = true)`       | Not present directly. Implied relationship via `UserAuthentication.user`.                                                                                                          | Auth-Server defines the owning side. CBT-back-diary implies it from `UserAuthentication`'s perspective.                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `customSettings`    | `List<UserCustomSetting>`, `@OneToMany(mappedBy = "user", cascade = CascadeType.ALL, orphanRemoval = true)`      | N/A (No `UserCustomSetting` entity in CBT-back-diary)                                                                                                                              | Auth-Server has user settings functionality.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Other**           | `@PrePersist`, `@PreUpdate`                                                                                       | `@PrePersist`, `@PreUpdate`, `getNickname()`, `getRole()`                                                                                                                            | CBT-back-diary has DTO mapping helper methods. Both manage `createdAt` and `updatedAt` via lifecycle callbacks, though CBT-back-diary also uses DB defaults.                                                                                                                                                                                                                                                                                                                                                                   |

| Feature             | AuthProvider (Auth-Server)                                                                                           | AuthProvider (CBT-back-diary)                                                                                                   | Differences / Notes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ------------------- | -------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Entity Name**     | `AuthProvider`                                                                                                       | `AuthProvider`                                                                                                                | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Project**         | Auth-Server                                                                                                          | CBT-back-diary                                                                                                                | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Purpose**         | Represents an authentication provider.                                                                               | Represents an authentication provider.                                                                                        | Same fundamental purpose.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **Fields**          |                                                                                                                      |                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `id`                | `Integer`, `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)`                                              | `Integer`, `@Id`, `@GeneratedValue(strategy = GenerationType.IDENTITY)`, `@Column(name = "id", updatable = false, nullable = false)` | CBT-back-diary explicitly defines `@Column`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `providerName`      | `String`, `@Column(name = "provider_name", nullable = false, length = 50, unique = true)`                              | `String`, `@Column(name = "provider_name", unique = true, nullable = false, length = 50)`                                       | Same.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `description`       | `String`, `@Column(nullable = true)`                                                                                 | `String`, `@Column(name = "description")`                                                                                       | CBT-back-diary explicitly names the column.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `isActive`          | `Boolean`, `@Builder.Default` true, `@Column(name = "is_active", nullable = false)`                                    | `boolean`, `@Builder.Default` true, `@Column(name = "is_active", nullable = false)`                                             | Auth-Server uses `Boolean` (object wrapper), CBT-back-diary uses `boolean` (primitive). Both default to `true`.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Relationships**   |                                                                                                                      |                                                                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `userAuthentications` | `List<UserAuthentication>`, `@OneToMany(mappedBy = "authProvider", cascade = CascadeType.ALL)`                       | Not present directly. Implied relationship via `UserAuthentication.authProvider`.                                                 | Auth-Server defines the owning side of the relationship. CBT-back-diary implies it from `UserAuthentication`'s perspective.                                                                                                                                                                                                                                                                                                                                                                                                                   |

| Feature             | UserAuthentication (Auth-Server)                                                                                                                                                                                                                                                                                             | UserAuthentication (CBT-back-diary)                                                                                                                                                                                                                                                                                                                                                         | Differences / Notes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Entity Name**     | `UserAuthentication`                                                                                                                                                                                                                                                                                                         | `UserAuthentication`                                                                                                                                                                                                                                                                                                                                                                        | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Project**         | Auth-Server                                                                                                                                                                                                                                                                                                                  | CBT-back-diary                                                                                                                                                                                                                                                                                                                                                                              | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Purpose**         | Links user to an auth provider.                                                                                                                                                                                                                                                                                              | Links user to an auth provider.                                                                                                                                                                                                                                                                                                                                                             | Same fundamental purpose.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Primary Key**     | `@EmbeddedId` (`UserAuthenticationId` class with `userId`, `authProviderId`)                                                                                                                                                                                                                                                   | `@IdClass(UserAuthenticationId.class)` (Separate `UserAuthenticationId` class with `user` (Long), `authProvider` (Integer)). Fields `user` and `authProvider` are marked with `@Id`.                                                                                                                                                                                                          | Both use composite keys. Auth-Server uses `@EmbeddedId` with a separate embeddable class for the ID. CBT-back-diary uses `@IdClass` with a separate ID class and marks the corresponding entity fields with `@Id`. The fields in `UserAuthenticationId` of CBT-back-diary are `Long user` and `Integer authProvider` directly referring to the types of the related entities' IDs. Auth-Server's `UserAuthenticationId` (not shown but implied by `@MapsId`) would also contain fields mapping to `User` and `AuthProvider` IDs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Kariera                                                                                                                                                                                                                                                                                                                                                                                    
| **Fields**          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `id`                | `UserAuthenticationId id`, `@EmbeddedId`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         As                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
  // This file describes the "Report" entity in the Auth-DONE project
  // It's important to update this file whenever User model details are changed for migrations/database schema updates
  //
  // For more information refer to:
  // https://docs.flutterflow.io/firebase/firestore/create-data-schema
  //
  //
  // This is the Firestore user record that is created for every user.
  // This data is stored in the Firestore collection `report`, and the document of the user is the user's document ID.
  // This is where user roles are stored for role based access control.
  // This role corresponds to the UserRole type in your Firestore Rules.
  //
  // See the documentation of roles here:
  // https://docs.flutterflow.io/managing-users/projects/user-management/user-roles-and-permissions
  //
  // You can update these fields from the Authentication page in your project.
  //
  // This is added by default when Firebase is enabled for your project
  // but is not managed by the database automatically.
  //
  // You can add fields to this document when you need to store additional data about the user.
  // For example, you can store a user's address in this document.
  //
  // Firestore schema version: 1
  //
  // This file defines the schema for a Firebase Firestore document representing a user's report.
  // It sets up the structure for storing report data, including the user who created it,
  // the title, the change process, and timestamps for creation and update.
  //
  // This document is linked to a user through the `user_id` field, which references the user's document ID in the Users collection.
  // The `summary_title` field stores the title of the report.
  // The `change_process` field stores the details of the change process.
  // The `created_at` and `updated_at` fields store the timestamps of when the report was created and last updated, respectively.
  //
  // The `Report` class is used by Firestore to represent the document in the Firestore database.
  // The `@Entity` annotation marks the class as a JPA entity, and the `@Table` annotation specifies the table name in the database.
  // The `@Data`, `@NoArgsConstructor`, `@AllArgsConstructor`, and `@Builder` annotations are Lombok annotations that generate boilerplate code for getters, setters, constructors, and builders.
  // The `@Id` annotation marks the `id` field as the primary key, and the `@GeneratedValue` annotation specifies that the ID is generated automatically by the database.
  // The `@ManyToOne` annotation defines a many-to-one relationship between the `Report` entity and the `User` entity.
  // The `@JoinColumn` annotation specifies the foreign key column in the `Report` table that links to the `User` table.
  // The `@Column` annotation specifies the column name and constraints for each field.
  // The `@Lob` annotation specifies that the `change_process` field can store large binary objects (e.g., text, images).
  // The `@PrePersist` and `@PreUpdate` annotations are JPA lifecycle callbacks that are executed before the entity is persisted or updated, respectively.
  // In this case, they are used to set the `created_at` and `updatedAt` fields to the current timestamp.
  
  package com.authentication.auth.domain;
  
  import jakarta.persistence.*;
  import lombok.AllArgsConstructor;
  import lombok.Builder;
  import lombok.Data;
  import lombok.NoArgsConstructor;
  
  import java.time.LocalDateTime;
  
  @Entity
  @Table(name = "Report")
  @Data
  @NoArgsConstructor
  @AllArgsConstructor
  @Builder
  public class Report {
  
      @Id
      @GeneratedValue(strategy = GenerationType.IDENTITY)
      private Long id;
  
      @ManyToOne(fetch = FetchType.LAZY)
      @JoinColumn(name = "user_id", nullable = false)
      private User user;
  
      @Column(name = "summary_title", nullable = false, length = 255)
      private String summaryTitle;
  
      @Lob
      @Column(name = "change_process", columnDefinition = "TEXT", nullable = true)
      private String changeProcess;
  
      @Column(name = "created_at", nullable = false, updatable = false)
      private LocalDateTime createdAt;
  
      @Column(name = "updated_at", nullable = false)
      private LocalDateTime updatedAt;
  
      @PrePersist
      protected void onCreate() {
          createdAt = LocalDateTime.now();
          updatedAt = LocalDateTime.now();
      }
  
      @PreUpdate
      protected void onUpdate() {
          updatedAt = LocalDateTime.now();
      }
  }
  ```

**Entities unique to Auth-Server:**

*   `EmailVerification.java` (though commented out)
*   `SettingsOption.java`
*   `UserCustomSetting.java`
*   `Report.java`
*   `DiaryReportLink.java`

**Summary of Key Findings:**

*   **User Entity Duplication:** Both projects have a `User` entity.
    *   **Fields:** Largely consistent with minor differences:
        *   `id`: CBT-back-diary explicitly adds `@Column` annotations.
        *   `password`: CBT-back-diary explicitly names the column `password`.
        *   `email`: Auth-Server specifies `length = 255`.
        *   `createdAt`, `updatedAt`: Both manage these timestamps, but CBT-back-diary additionally uses `@Builder.Default` and database-level `DEFAULT CURRENT_TIMESTAMP` and `ON UPDATE CURRENT_TIMESTAMP`. Auth-Server relies on `@PrePersist`/`@PreUpdate`.
        *   `userRole`: Auth-Server has a `@Builder.Default` to "USER".
        *   `isPremium`: Auth-Server uses `Boolean` (wrapper), CBT-back-diary uses `boolean` (primitive).
    *   **Relationships:**
        *   Auth-Server's `User` has explicit `@OneToMany` relationships to `Diary`, `UserAuthentication`, and `UserCustomSetting`.
        *   CBT-back-diary's `User` does not explicitly define these outgoing relationships, but they are implied by the `@ManyToOne` relationships in `Diary` and `UserAuthentication`.

*   **AuthProvider Entity Duplication:** Both projects have an `AuthProvider` entity.
    *   **Fields:** Very similar.
        *   `id`: CBT-back-diary explicitly adds `@Column` annotations.
        *   `description`: CBT-back-diary explicitly names the column `description`.
        *   `isActive`: Auth-Server uses `Boolean` (wrapper), CBT-back-diary uses `boolean` (primitive).
    *   **Relationships:**
        *   Auth-Server's `AuthProvider` has an explicit `@OneToMany` to `UserAuthentication`.
        *   CBT-back-diary's `AuthProvider` does not, but the relationship is implied by `UserAuthentication.authProvider`.

*   **UserAuthentication Entity Duplication:** Both projects have a `UserAuthentication` entity.
    *   **Purpose:** Both serve to link users to their social/external authentication providers.
    *   **Primary Key:**
        *   Auth-Server uses `@EmbeddedId` with a separate `UserAuthenticationId` class.
        *   CBT-back-diary uses `@IdClass` with a separate `UserAuthenticationId` class and marks the `user` and `authProvider` fields with `@Id`. The types within its `UserAuthenticationId` directly match the ID types of `User` and `AuthProvider`.
    *   **Fields:**
        *   `socialId`: Same.
        *   `createdAt`, `updatedAt`: Similar to the `User` entity, CBT-back-diary uses `@Builder.Default` and database defaults, while Auth-Server uses `@PrePersist`/`@PreUpdate`.
    *   **Relationships:**
        *   Auth-Server: `user` and `authProvider` are mapped using `@MapsId`.
        *   CBT-back-diary: `user` and `authProvider` are part of the composite key using `@Id` and `@JoinColumn` specifies `referencedColumnName = "id"`.

*   **Diary Entity Duplication:** Both projects have a `Diary` entity.
    *   **Fields:**
        *   `id`: CBT-back-diary explicitly adds `@Column` annotations.
        *   `createdAt`, `updatedAt`: Similar pattern as `User` and `UserAuthentication` regarding defaults and lifecycle callbacks.
        *   `title`: Same.
        *   `content`: Same.
        *   `alternativeThought` (Auth-Server) vs `aiAlternativeThoughts` (CBT-back-diary): Field name differs, but purpose seems similar (storing AI-generated or alternative thoughts). CBT-back-diary's column name is `alternative_thought`.
        *   `isNegative`: Auth-Server defaults to `false`. CBT-back-diary's `isNegative` is `Boolean` (nullable).
        *   `diaryDate`: CBT-back-diary has an additional `LocalDate diaryDate` field, which is not present in Auth-Server's `Diary`.
    *   **Relationships:**
        *   Both have a `@ManyToOne` relationship to `User`.

**Potential Conflicts & Inconsistencies:**

1.  **User Entity:**
    *   The difference in handling `createdAt` and `updatedAt` (Java-level defaults vs. DB defaults) might lead to slightly different behavior if not carefully managed, though both aim for automatic timestamping.
    *   The `Boolean` vs `boolean` for `isPremium` is a minor type difference.
    *   Auth-Server's `User` explicitly defines collections for `diaries`, `authentications`, and `customSettings`. CBT-back-diary's `User` does not, relying on the other side of the relationship. This isn't a direct conflict but a difference in mapping style.

2.  **AuthProvider Entity:**
    *   Similar `Boolean` vs `boolean` for `isActive` as in the `User` entity.

3.  **UserAuthentication Entity:**
    *   The primary key definition strategy (`@EmbeddedId` vs. `@IdClass`) is different, though both achieve a composite key. The underlying database structure would likely be the same (a composite primary key on `user_id` and `auth_provider_id`).
    *   Timestamp handling differences as noted for `User`.

4.  **Diary Entity:**
    *   The most significant difference is the `diaryDate` field in CBT-back-diary's `Diary`, which is absent in Auth-Server.
    *   The naming difference for `alternativeThought` vs `aiAlternativeThoughts` (though the DB column name seems to be `alternative_thought` for CBT-back-diary as well).
    *   The `isNegative` field in Auth-Server defaults to `false`, while in CBT-back-diary it's a `Boolean` which can be null if the DB allows.

**Unique Entities:**

*   **Auth-Server only:** `EmailVerification`, `SettingsOption`, `UserCustomSetting`, `Report`, `DiaryReportLink`. These entities suggest Auth-Server has more features around user settings, email verification, and a more structured reporting system that links multiple diaries to a single report.

**Conclusion on User Information:**

User information is indeed duplicated across both `User` entities. The core fields (`id`, `password`, `email`, `userName`, `userRole`, `isPremium`, `isActive`, `lastLogin`, `createdAt`, `updatedAt`) are present in both, with minor variations in annotations, default value handling, and primitive vs. wrapper types. The fundamental structure and purpose are very similar.

**Potential Relationship Conflicts:**

*   The main "conflict" is more about how relationships are expressed. Auth-Server often defines bidirectional relationships (e.g., `User` has a list of `Diary` objects, and `Diary` has a reference to `User`). CBT-back-diary tends to define the unidirectional `@ManyToOne` side (e.g., `Diary` has a `User`) and relies on queries or services to fetch related collections if needed from the `User` side. This isn't a conflict that would break database integrity if schemas are aligned but represents different ORM mapping approaches.
*   If these entities were to be merged, decisions would need to be made on which relationship mapping style to adopt uniformly.

This detailed analysis should provide a good foundation for understanding the entity landscape across both projects.
```
